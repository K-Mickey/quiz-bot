# Бот викторин

Бот может быть использован для проведения викторин. 
Предоставляет возможность задавать случайные вопросы и проверять ответы. 
Данные ответов защищены от потери и ошибок, потому что они сохраняются в отдельной базе данных.
Реализован для пользователей в ВКонтакте и Телеграм.

![tg.gif](src/tg-example.gif)

![vk.gif](src/vk-example.gif)


## Основные технологии
- Python
- Aiogram
- VKBottle
- Redis

## Установка
### Подготовка
Создайте файл `.env` в корне проекта и заполните его данными. Пример данных в файле `.env.example`.
Обязательные переменные:
- `TG_TOKEN` - токен бота в Телеграме. Узнать его можно [здесь](https://t.me/BotFather)
- `TG_REDIS_URL` - адрес базы данных Redis для хранения данных бота в Телеграме
- `VK_TOKEN` - токен бота в ВКонтакте. Узнать его можно в настройках вашего сообщества
- `VK_REDIS_URL` - адрес базы данных Redis для хранения данных бота в ВКонтакте
- `REDIS_PASSWORD` - пароль для доступа к базе данных Redis

Опциональные переменные:
- `LOG_LEVEL` - уровень логирования
- `LOG_FORMAT` - формат логирования

Если вы планируете использовать Docker, то в `.env.example` приведены необходимые urls для подключения к базам данных.

Также нужно создать папку `questions` в корне проекта и добавить в нее файлы с вопросами. 
Подробнее об этом в разделе "Добавление вопросов".
### Docker
Если у вас уже установлен [Docker](https://www.docker.com/), то можете развернуть весь проект в контейнере. 
Для этого после создания файла `.env` выполните команду:
```bash
docker compose up -d
```

### Docker Slim
Вариант, если вы хотите развернуть в контейнере только redis, то выполните команду:
```bash
docker compose -f docker-compose-slim.yml up -d
```
При этом ботов можно будет запустить локально. redis будет доступен по адресу `redis://password@localhost:6380/0`

### Локально
Для локального разворачивания создайте виртуальное окружение, активируйте его, установите uv и зависимости:
```bash
python -m venv venv
source venv/bin/activate
pip install uv
uv sync --locked --no-dev --no-cache
```
После этого подготовьте файл `.env` и redis. Ботов можно запустить командами:
```bash
uv run tg_bot.py
uv run vk_bot.py
```

## Добавление вопросов

Файлы с вопросами должны находиться в директории `questions`.
Скачайте [архив с вопросами](https://dvmn.org/media/modules_dist/quiz-questions.zip) и распакуйте его в эту директорию.
Также можете добавить свои вопросы вручную. 
При создании своего файла будьте внимательными с переносами строк. 
Они должны совпадать с примером.  
Пример файла вопросов:
```txt
Чемпионат:
Один против дюжины. 2000 год

Дата:
00-000-2000

Тур:
Тур 34

Вопрос 1:
С одним советским туристом в Марселе произошел такой случай. Спустившись
из своего номера на первый этаж, он вспомнил, что забыл закрутить кран в
ванной. Когда он поднялся, вода уже затопила комнату. Он вызвал
горничную, та попросила его обождать внизу. В страхе он ожидал расплаты
за свою оплошность. Но администрация его не ругала, а, напротив,
извинилась сама перед ним. За что?

Ответ:
За то, что не объяснила ему правила пользования кранами.

Автор:
Максим Поташев


Вопрос 2:
В своем первоначально узком значении это слово произошло от французского
глагола, означающего "бить". Сейчас же оно может означать любое
объединение в систему нескольких однотипных элементов. Назовите это
слово.

Ответ:
Батарея (от battre).

Источник:
СЭС

Автор:
Вадим Карлинский
```

## Цели проекта
Код написан в учебных целях — это урок в курсе по Python и веб-разработке на сайте [Devman.org](https://devman.org).